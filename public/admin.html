<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - SMK Negeri 1 Majalengka</title>
    <link rel="stylesheet" href="css/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="admin-dashboard">
       
        <aside class="sidebar" id="adminSidebar">
            <div class="sidebar-logo">
                <img src="assets/logo-stemanika.png" alt="Logo SMK Negeri 1 Majalengka" class="highlight-logo">
                <span class="sidebar-school-name">SMK NEGERI 1 MAJALENGKA</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle" aria-label="Menu" style="display:none;">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
            <nav class="sidebar-menu">
                <a href="#" class="sidebar-link active" data-section="school-info"><i class="fas fa-school"></i> Informasi Sekolah</a>
                <a href="#" class="sidebar-link" data-section="eskul"><i class="fas fa-users"></i> Ekstrakurikuler</a>
                <a href="#" class="sidebar-link" data-section="election"><i class="fas fa-vote-yea"></i> Pemilihan Ketos</a>
                <a href="#" class="sidebar-link" data-section="schedule"><i class="fas fa-calendar-alt"></i> Jadwal Pelajaran</a>
                <a href="#" class="sidebar-link" data-section="exam"><i class="fas fa-file-alt"></i> Link Ujian</a>
                <a href="#" class="sidebar-link" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </nav>
        </aside>
      
        <main class="main-content">
            <header class="admin-header">
                <h1>Dashboard Admin</h1>
                <div class="admin-user">
                    <i class="fas fa-user-shield"></i>
                    <span id="adminName">Administrator</span>
                </div>
            </header>
            <section class="admin-section" id="adminSection">
                <div class="welcome-section">
                    <h2>Selamat Datang di Dashboard Admin</h2>
                    <p>Kelola seluruh fitur website sekolah dengan mudah dan aman.<br>Gunakan menu di samping untuk mengelola informasi sekolah, ekstrakurikuler, pemilihan ketos, jadwal pelajaran, dan lainnya.</p>
                </div>
                <div class="admin-section">
                    <h2>Edit Visi & Misi</h2>
                    <form id="profilForm">
                        <label>Visi</label>
                        <textarea id="visiInput"></textarea>
                        <label>Misi</label>
                        <textarea id="misiInput"></textarea>
                        <button type="submit">Simpan</button>
                    </form>
                </div>
                <div class="admin-section">
                    <h2>Formulir Kandidat</h2>
                    <form class="form-kandidat" method="POST" action="/api/kandidat">
                        <label for="nomor_kandidat">Nomor Urut</label>
                        <input type="number" id="nomor_kandidat" name="nomor_kandidat" placeholder="Nomor Urut" required>

                        <label for="nama">Nama Lengkap</label>
                        <input type="text" id="nama" name="nama" placeholder="Nama Lengkap" required>

                        <label for="nis">NIS</label>
                        <input type="text" id="nis" name="nis" placeholder="NIS" required>

                        <label for="posisi">Posisi</label>
                        <select id="posisi" name="posisi" required>
                            <option value="">Pilih Posisi</option>
                            <option value="ketos">Ketua OSIS</option>
                            <option value="waketos">Wakil Ketua OSIS</option>
                            <option value="ketua-mpk">Ketua MPK</option>
                            <option value="wakil-ketua-mpk">Wakil Ketua MPK</option>
                        </select>

                        <label for="visi">Visi</label>
                        <textarea id="visi" name="visi" placeholder="Visi" required></textarea>

                        <label for="misi">Misi</label>
                        <textarea id="misi" name="misi" placeholder="Misi" required></textarea>

                        <button type="submit" class="btn btn-primary">Simpan Kandidat</button>
                    </form>
                </div>
               
            </section>
        </main>
    </div>
    
    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width:350px;text-align:center;">
            <span class="close" onclick="closeModal('confirmModal')">&times;</span>
            <h2 id="confirmTitle">Konfirmasi</h2>
            <p id="confirmMessage">Apakah Anda yakin?</p>
            <div style="margin-top:2rem;display:flex;gap:1rem;justify-content:center;">
                <button class="btn btn-primary" id="confirmYesBtn">Ya</button>
                <button class="btn btn-secondary" onclick="closeModal('confirmModal')">Batal</button>
            </div>
        </div>
    </div>
    
    <script>

fetch('/api/user').then(r => r.json()).then(data => {
  if (!data.user || data.user.role !== 'admin') {
    window.location.href = '/';
  }
});

// Sidebar toggle for mobile
const sidebar = document.getElementById('adminSidebar');
const sidebarToggle = document.getElementById('sidebarToggle');
function checkSidebarToggle() {
  if (window.innerWidth <= 900) {
    sidebarToggle.style.display = 'flex';
    sidebar.classList.add('collapsed');
  } else {
    sidebarToggle.style.display = 'none';
    sidebar.classList.remove('collapsed');
  }
}
sidebarToggle.onclick = function() {
  sidebar.classList.toggle('collapsed');
};
window.addEventListener('resize', checkSidebarToggle);
document.addEventListener('DOMContentLoaded', checkSidebarToggle);

sidebar.querySelectorAll('.sidebar-link').forEach(link => {
  link.addEventListener('click', function() {
    if (window.innerWidth <= 900) {
      sidebar.classList.add('collapsed');
    }
  });
});
</script>
    <script src="js/admin.js"></script>
</body>
</html>